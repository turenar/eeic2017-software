参考実装です。

問題と合致した実装かどうかは保証しません
